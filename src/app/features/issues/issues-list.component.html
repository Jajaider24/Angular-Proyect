<div class="form-container">
  <app-list-header
    [title]="'Incidencias'"
    [subtitle]="'Registrar fallas y accidentes'"
    [lucide]="'AlertTriangle'"
    [breadcrumb]="[
      { label: 'Dashboard', link: ['/dashboard'] },
      { label: 'Incidencias' }
    ]"
    [actionText]="'Nueva incidencia'"
    [actionLink]="['/issues/new']"
    [actionLucide]="'Plus'"
  ></app-list-header>

  <div class="d-flex justify-content-end mb-2">
    <button class="btn btn-outline-secondary btn-sm" (click)="refresh()">Refrescar</button>
  </div>

  <div *ngIf="loading" class="text-center py-4">
    <div class="spinner-border" role="status"></div>
  </div>

  <div *ngIf="!loading && items.length === 0" class="text-muted py-4">
    No hay incidencias registradas.
  </div>

  <div *ngIf="!loading && items.length > 0" class="table-responsive">
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>ID</th>
          <th>Descripci√≥n</th>
          <th>Tipo</th>
          <th>Motocicleta</th>
          <th>Reportado</th>
          <th>Estado</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let i of items">
          <td>{{ i.id }}</td>
          <td>{{ i.description }}</td>
          <td>{{ i.issueType }}</td>
          <td>{{ i.motorcycleId }}</td>
          <td>{{ i.dateReported | date: 'short' }}</td>
          <td>
            <span class="badge bg-secondary" *ngIf="i.status === 'open'">Abierta</span>
            <span class="badge bg-info" *ngIf="i.status === 'in_progress'">En progreso</span>
            <span class="badge bg-success" *ngIf="i.status === 'resolved'">Resuelta</span>
          </td>
          <td class="text-end">
            <button class="btn btn-sm btn-outline-info me-1" (click)="view(i.id)">Ver</button>
            <button class="btn btn-sm btn-outline-primary me-1" (click)="edit(i.id)">Editar</button>
            <button class="btn btn-sm btn-outline-danger" (click)="remove(i.id)">Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
